<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background-color: #000000; color: #e7e9ea; font-family: -apple-system, sans-serif; overflow-y: scroll; }
        .x-border { border-color: #2f3336; }
        .x-hover:hover { background-color: rgba(231, 233, 234, 0.1); transition: 0.2s; }
        .btn-blue { background-color: #1d9bf0; transition: 0.2s; }
        .btn-blue:hover { background-color: #1a8cd8; }
        .btn-blue:disabled { opacity: 0.5; }
        .active-tab { border-bottom: 4px solid #1d9bf0; color: #e7e9ea; font-weight: bold; }
        .hidden { display: none; }
        input:focus, textarea:focus { outline: none; border-color: #1d9bf0; }
        .icon { width: 24px; height: 24px; fill: currentColor; }
        .icon-sm { width: 18px; height: 18px; fill: currentColor; }
        ::-webkit-scrollbar { width: 0px; }
        .modal-bg { background: rgba(91, 112, 131, 0.4); }
        /* トースト通知アニメーション */
        #toast { transition: transform 0.3s ease, opacity 0.3s ease; transform: translateY(100px); }
        #toast.show { transform: translateY(0); opacity: 1; }
    </style>
</head>
<body class="flex justify-center min-h-screen">

    <div id="toast" class="fixed bottom-12 left-1/2 -translate-x-1/2 z-[200] bg-[#1d9bf0] text-white px-4 py-3 rounded-md shadow-lg opacity-0 pointer-events-none text-sm font-medium">
        エラーが発生しました
    </div>

    <div id="edit-modal" class="fixed inset-0 z-[110] modal-bg flex items-center justify-center hidden">
        <div class="bg-black w-full max-w-[600px] rounded-2xl border x-border overflow-hidden">
            <div class="flex items-center justify-between p-4">
                <div class="flex items-center gap-6">
                    <button onclick="toggleEditModal()" class="text-xl p-2 x-hover rounded-full">✕</button>
                    <span class="text-xl font-bold">プロフィールを編集</span>
                </div>
                <button onclick="saveProfile()" class="bg-white text-black px-4 py-1.5 rounded-full font-bold">保存</button>
            </div>
            <div class="p-4 space-y-6">
                <div class="border x-border p-2 rounded focus-within:border-[#1d9bf0]">
                    <label class="text-xs text-[#71767b] block">名前</label>
                    <input id="edit-name" type="text" class="w-full bg-transparent outline-none text-lg">
                </div>
                <div class="border x-border p-2 rounded focus-within:border-[#1d9bf0]">
                    <label class="text-xs text-[#71767b] block">自己紹介</label>
                    <textarea id="edit-bio" class="w-full bg-transparent outline-none text-lg h-24 resize-none"></textarea>
                </div>
            </div>
        </div>
    </div>

    <header id="sidebar" class="w-[70px] xl:w-[275px] flex flex-col h-screen sticky top-0 px-2 border-r x-border">
        <div class="p-3 mb-2 flex justify-center xl:justify-start">
            <svg viewBox="0 0 24 24" class="h-8 w-8 fill-white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.88-11.71c.36.14.62.47.62.85 0 .3-.14.57-.38.74l-3.32 2.37 3.32 2.37c.24.17.38.44.38.74 0 .38-.26.71-.62.85l-4.5 1.8c-.12.05-.25.07-.38.07-.55 0-1-.45-1-1v-8c0-.55.45-1 1-1 .13 0 .26.02.38.07l4.5 1.8z" style="display:none;"/><path d="M11 18c-2.21 0-4-1.79-4-4 0-1.1.45-2.1 1.17-2.83l1.41 1.41C9.21 12.96 9 13.46 9 14c0 1.1.9 2 2 2h2c1.1 0 2-.9 2-2 0-1.1-.9-2-2-2h-1c-2.21 0-4-1.79-4-4 0-2.21 1.79-4 4-4h2c2.21 0 4 1.79 4 4 0 1.1-.45 2.1-1.17 2.83l-1.41-1.41c.37-.38.58-.88.58-1.42 0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2 0 1.1.9 2 2 2h1c2.21 0 4 1.79 4 4 0 2.21-1.79 4-4 4h-2z"/></svg>
        </div>
        <nav class="flex-1">
            <div onclick="nav('home')" class="flex items-center gap-4 p-3 text-xl x-hover rounded-full cursor-pointer w-fit xl:pr-8 mx-auto xl:mx-0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M12 9L21 16V22H15V17H9V22H3V16L12 9Z M12 2.5L21 9.5V11L12 4L3 11V9.5L12 2.5Z"/></svg>
                <span class="hidden xl:inline">ホーム</span>
            </div>
            <div onclick="nav('explore')" class="flex items-center gap-4 p-3 text-xl x-hover rounded-full cursor-pointer w-fit xl:pr-8 mx-auto xl:mx-0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M21.5 20.4L16 14.9C17 13.5 17.6 11.8 17.6 10C17.6 5.8 14.2 2.4 10 2.4S2.4 5.8 2.4 10 5.8 17.6 10 17.6C11.8 17.6 13.5 17 14.9 16L20.4 21.5L21.5 20.4ZM10 16C6.7 16 4 13.3 4 10S6.7 4 10 4 16 6.7 16 10 13.3 16 10 16Z"/></svg>
                <span class="hidden xl:inline">話題を検索</span>
            </div>
            <div onclick="nav('profile', 'me')" class="flex items-center gap-4 p-3 text-xl x-hover rounded-full cursor-pointer w-fit xl:pr-8 mx-auto xl:mx-0">
                <svg viewBox="0 0 24 24" class="icon"><path d="M12 12c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm0 2c-2.7 0-8 1.3-8 4v2h16v-2c0-2.7-5.3-4-8-4z"/></svg>
                <span class="hidden xl:inline">プロフィール</span>
            </div>
        </nav>
        <div class="mt-auto mb-4 p-3 flex items-center gap-3 x-hover rounded-full cursor-pointer" onclick="logout()">
            <div class="w-10 h-10 rounded-full bg-blue-500"></div>
            <div class="hidden xl:block overflow-hidden">
                <p id="side-name" class="font-bold truncate"></p>
                <p class="text-[#71767b] text-sm">設定・ログアウト</p>
            </div>
        </div>
    </header>

    <main id="main-content" class="w-full max-w-[600px] border-r x-border min-h-screen">
        
        <div id="view-home">
            <div class="sticky top-0 bg-black/80 backdrop-blur-md z-10 border-b x-border font-bold text-xl p-4">ホーム</div>
            <div class="p-4 border-b x-border flex gap-4">
                <div class="w-10 h-10 rounded-full bg-blue-500 shrink-0"></div>
                <div class="flex-1">
                    <textarea id="post-input" placeholder="いまどうしてる？" class="w-full bg-transparent text-xl py-2 outline-none resize-none h-14" oninput="togglePostBtn('post-btn', 'post-input')"></textarea>
                    <div class="flex justify-end pt-3 border-t x-border mt-2">
                        <button id="post-btn" onclick="submitPost()" disabled class="btn-blue text-white px-5 py-2 rounded-full font-bold">ポストする</button>
                    </div>
                </div>
            </div>
            <div id="home-timeline"></div>
        </div>

        <div id="view-explore" class="hidden">
            <div class="p-4 sticky top-0 bg-black/80 backdrop-blur-md z-10 border-b x-border">
                <input type="text" id="search-input" placeholder="話題を検索" oninput="renderSearch()" class="w-full bg-[#202327] rounded-full p-3 px-6 outline-none focus:bg-black focus:border focus:border-[#1d9bf0]">
            </div>
            <div id="search-results"></div>
        </div>

        <div id="view-profile" class="hidden">
            <div class="flex items-center gap-8 p-2 sticky top-0 bg-black/80 backdrop-blur-md z-10 border-b x-border">
                <button onclick="nav('home')" class="p-2 x-hover rounded-full">
                    <svg viewBox="0 0 24 24" class="icon-sm"><path d="M20 11H7.8l5.6-5.6L12 4l-8 8 8 8 1.4-1.4L7.8 13H20v-2z"/></svg>
                </button>
                <div>
                    <h2 id="prof-header-name" class="font-bold text-xl"></h2>
                    <p id="prof-post-count" class="text-xs text-[#71767b]"></p>
                </div>
            </div>
            <div class="h-40 bg-[#333639]"></div>
            <div class="p-4 relative border-b x-border">
                <div class="w-32 h-32 rounded-full border-4 border-black bg-blue-500 -mt-16 absolute"></div>
                <div class="text-right h-10" id="prof-action-area">
                    </div>
                <div class="mt-8">
                    <h2 id="prof-name" class="text-xl font-bold"></h2>
                    <p id="prof-handle" class="text-[#71767b]"></p>
                    <p id="prof-bio" class="mt-3"></p>
                </div>
                <div class="flex gap-4 mt-3 text-sm text-[#71767b]">
                    <span><b class="text-white" id="count-following">0</b> フォロー中</span>
                    <span><b class="text-white" id="count-followers">0</b> フォロワー</span>
                </div>
            </div>
            <div class="flex border-b x-border text-center">
                <div id="tab-posts" onclick="setTab('posts')" class="flex-1 py-4 x-hover cursor-pointer active-tab">ポスト</div>
                <div id="tab-likes" onclick="setTab('likes')" class="flex-1 py-4 x-hover cursor-pointer text-[#71767b]">いいね</div>
            </div>
            <div id="profile-timeline"></div>
        </div>
    </main>

    <aside id="right-aside" class="w-[350px] hidden lg:block p-4 sticky top-0 h-screen">
        <div class="bg-[#16181c] rounded-2xl border x-border p-4">
            <h2 class="text-xl font-bold mb-4">おすすめユーザー</h2>
            <div id="suggestion-list"></div>
        </div>
    </aside>

    <script src="js/app.js"></script>
</body>
</html>
